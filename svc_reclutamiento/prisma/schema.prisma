generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Reclutamiento {
  id                Int              @id @default(autoincrement())
  fechaSolicitud    DateTime
  estadoPerfilCargo EstadoPerfilCargo

  // Información del cargo
  cargoRequerido       String
  division             String
  area                 String
  numeroVacantes       Int
  convocatoriaInterna  Boolean
  plataformas          String[]
  solicitaLineaCelular Boolean

  // Motivo
  motivoVacante  String
  reemplazaA     String?
  funciones      String
  objetivoCargo  String
  esComercial    Boolean

  // Info adicional / KPIs
  infoAdicional  String?
  kpi            String
  financieraVoBo Boolean
  ceoVoBo        Boolean

  // Información técnica
  conocimientosTecnicos String
  certificaciones       String
  sede                  String
  horario               String
  observaciones         String?

  // Solicitante
  solicitanteNombre String
  solicitanteCargo  String
  solicitanteArea   String

  // Estado del proceso de reclutamiento (NUEVO)
  estado EstadoRequisicion @default(pendiente)
  historialEstado ReclutamientoEstadoHistorial[]

  createdAt DateTime @default(now())
}

enum EstadoPerfilCargo {
  Actualizado
  PorCrear
}

enum EstadoRequisicion {
  pendiente
  en_revision
  aprobada
  publicada
  cerrada
  rechazada
}

model ReclutamientoEstadoHistorial {
  id              Int                @id @default(autoincrement())
  reclutamientoId Int
  estadoAnterior  EstadoRequisicion
  estadoNuevo     EstadoRequisicion
  comentario      String?
  usuario         String             // quién hizo el cambio
  fecha           DateTime           @default(now())

  reclutamiento   Reclutamiento      @relation(fields: [reclutamientoId], references: [id])
}
